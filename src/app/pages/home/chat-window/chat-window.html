<div class="window-container">
    <div class="room-name-container">
        <div class="chat-room-name-add-buttons">
            <button matButton="tonal" matTooltip="Click to change chat name" (click)="changeChatName()">{{currentRoom.roomName}}</button>
            @if(currentRoom.restrictions == 'private-group' && currentRoom.ownerId == currentUserId){
                <button matIconButton [matMenuTriggerFor]="addMenu" matTooltip="Add users to group"><mat-icon>person_add</mat-icon></button>
                <mat-menu #addMenu="matMenu">
                    <button mat-menu-item *ngFor="let user of allUsers" (click)="addUserToPrivateGroup(user.id, user)"><mat-icon>person</mat-icon>{{user.username}}</button>
                </mat-menu>
                <button matIconButton [matMenuTriggerFor]="removeMenu" matTooltip="Remove users group"><mat-icon>person_remove</mat-icon></button>
                 <mat-menu #removeMenu="matMenu">
                    <button mat-menu-item *ngFor="let user of memberUsers" (click)="removeUserFromPrivateGroup(user.id)"><mat-icon>person</mat-icon>{{user.username}}</button>
                </mat-menu>
            }
        </div>
        <div class="chat-room-buttons">
            <button matIconButton matTooltip="Close chat" (click)="handleCloseChat()" style="margin:10px;"><mat-icon>keyboard_return</mat-icon></button>
            
            <button matIconButton matTooltip="Delete chat" (click)="deleteChat()" style="color:red;"><mat-icon>delete</mat-icon></button>
        </div>
    </div>
    <mat-divider></mat-divider>
    <div #scrollContainer class="messages-container">
        <div *ngFor="let msg of messages$ | async" [ngClass]="msg.senderId === currentUserId ? 'current-user-message' : 'partner-message'">
            <div class="message-contents">
                <p class="sender-name">from: {{msg.senderName}}</p>
                <p class="message-bubble">{{msg.content}}</p>
            </div>
        </div>
    </div>
    <mat-divider></mat-divider>
    <div class="input-field-container">
        <input [(ngModel)]="newMessage" type="text" placeholder="Write a message..." class="message-input">
        <button matIconButton (click)="sendMessage()" class="send-button"><mat-icon>send</mat-icon></button>
    </div>
</div>